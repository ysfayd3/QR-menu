<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Debug</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">üîç Admin Panel Debug</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- LocalStorage Durumu -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">LocalStorage Durumu</h2>
                <button onclick="checkLocalStorage()" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mb-4">
                    Kontrol Et
                </button>
                <div id="storage-info" class="text-sm font-mono bg-gray-100 p-4 rounded whitespace-pre-wrap"></div>
            </div>
            
            <!-- √úr√ºn Listesi -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">√úr√ºn Listesi</h2>
                <button onclick="listProducts()" class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 mb-4">
                    √úr√ºnleri Listele
                </button>
                <div id="products-list" class="text-sm font-mono bg-gray-100 p-4 rounded whitespace-pre-wrap max-h-96 overflow-y-auto"></div>
            </div>
            
            <!-- Test √úr√ºn Ekle -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Test √úr√ºn Ekle</h2>
                <button onclick="addTestProduct()" class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 mb-4">
                    Test √úr√ºn√º Ekle
                </button>
                <div id="add-result" class="text-sm font-mono bg-gray-100 p-4 rounded whitespace-pre-wrap"></div>
            </div>
            
            <!-- Temizle -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Temizleme</h2>
                <button onclick="clearAllData()" class="w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 mb-4">
                    T√ºm Verileri Sil
                </button>
                <button onclick="reloadPage()" class="w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                    Sayfayƒ± Yenile
                </button>
            </div>
        </div>
        
        <div class="mt-6 bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-bold mb-4">Admin Paneline Git</h2>
            <a href="admin.html" class="inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                Admin Panel'i A√ß
            </a>
        </div>
    </div>

    <script src="local-database.js"></script>
    <script>
        function checkLocalStorage() {
            const output = document.getElementById('storage-info');
            let info = '';
            
            try {
                // LocalDB'yi ba≈ülat
                LocalDB.initialize();
                
                // Depolama istatistikleri
                const stats = LocalDB.stats.getStorageUsage();
                info += '=== DEPOLAMA ===\n';
                info += `Kullanƒ±lan: ${stats.used} MB\n`;
                info += `Toplam: ${stats.max} MB\n`;
                info += `Y√ºzde: %${stats.percentage}\n`;
                info += `Bo≈ü: ${stats.available} MB\n\n`;
                
                // √úr√ºn istatistikleri
                const productStats = LocalDB.stats.getProductStats();
                info += '=== √úR√úNLER ===\n';
                info += `Toplam: ${productStats.totalProducts}\n`;
                info += `Fotoƒüraflƒ±: ${productStats.withImages}\n`;
                info += `Fotoƒürafsƒ±z: ${productStats.withoutImages}\n\n`;
                
                // Kategoriler
                const categories = LocalDB.categories.getAll();
                info += '=== KATEGORƒ∞LER ===\n';
                info += `Toplam: ${categories.length}\n`;
                categories.forEach(cat => {
                    info += `- ${cat.name} (${cat.id})\n`;
                });
                
                output.textContent = info;
                
            } catch (error) {
                output.textContent = '‚ùå HATA: ' + error.message;
            }
        }
        
        function listProducts() {
            const output = document.getElementById('products-list');
            let list = '';
            
            try {
                const products = LocalDB.menu.getAll();
                
                if (products.length === 0) {
                    list = 'Hi√ß √ºr√ºn yok!';
                } else {
                    list = `Toplam ${products.length} √ºr√ºn:\n\n`;
                    products.forEach((p, index) => {
                        list += `${index + 1}. ${p.name}\n`;
                        list += `   ID: ${p.id}\n`;
                        list += `   Kategori: ${p.category}\n`;
                        list += `   Fiyat: ${p.price}\n`;
                        list += `   Fotoƒüraf: ${p.image ? 'Var (' + (p.image.length / 1024).toFixed(2) + ' KB)' : 'Yok'}\n`;
                        list += `   A√ßƒ±klama: ${p.description || '-'}\n\n`;
                    });
                }
                
                output.textContent = list;
                
            } catch (error) {
                output.textContent = '‚ùå HATA: ' + error.message;
            }
        }
        
        function addTestProduct() {
            const output = document.getElementById('add-result');
            
            try {
                const testProduct = {
                    id: Date.now(),
                    name: 'Test √úr√ºn√º ' + new Date().toLocaleTimeString(),
                    category: 'sicak',
                    price: '99‚Ç∫',
                    image: '',
                    description: 'Debug i√ßin eklenen test √ºr√ºn√º',
                    details: {
                        ingredients: 'Test malzemeler',
                        serving: 'Test sunum',
                        calories: '~100 kcal',
                        note: 'Test notu'
                    }
                };
                
                // √úr√ºn√º ekle
                const products = LocalDB.menu.getAll();
                products.push(testProduct);
                const saved = LocalDB.menu.saveAll(products);
                
                if (saved) {
                    output.textContent = '‚úÖ Test √ºr√ºn√º eklendi!\n\n';
                    output.textContent += `ID: ${testProduct.id}\n`;
                    output.textContent += `Ad: ${testProduct.name}\n`;
                    output.textContent += `Kategori: ${testProduct.category}\n`;
                    output.textContent += `Fiyat: ${testProduct.price}\n\n`;
                    output.textContent += '≈ûimdi admin.html\'i a√ßƒ±n ve kontrol edin!';
                } else {
                    output.textContent = '‚ùå √úr√ºn eklenemedi!';
                }
                
            } catch (error) {
                output.textContent = '‚ùå HATA: ' + error.message;
            }
        }
        
        function clearAllData() {
            if (confirm('‚ö†Ô∏è T√úM VERƒ∞LER Sƒ∞Lƒ∞NECEK! Emin misiniz?')) {
                try {
                    LocalDB.clearAll();
                    alert('‚úÖ T√ºm veriler silindi!');
                    location.reload();
                } catch (error) {
                    alert('‚ùå Hata: ' + error.message);
                }
            }
        }
        
        function reloadPage() {
            location.reload();
        }
        
        // Sayfa y√ºklendiƒüinde otomatik kontrol
        window.addEventListener('load', () => {
            checkLocalStorage();
            listProducts();
        });
    </script>
</body>
</html>
